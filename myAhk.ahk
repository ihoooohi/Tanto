#Requires AutoHotkey v2.0
#SingleInstance Force

; ==============================================================================
; 1. 基础按键改造
; ==============================================================================

; 将 Caps Lock 彻底变为 Ctrl
; 如果你想保留原有的 Caps Lock 功能，可以使用 Shift + CapsLock 来触发
CapsLock::Lshift


; ==============================================================================
; 2. 右手十字星导航 (Ctrl + I J K L)
; 由于 Caps Lock 已经改成了 Ctrl，这里直接使用 ^ (Ctrl)
; ==============================================================================

^i::Send("{Up}")      ; 上
^k::Send("{Down}")    ; 下
^j::Send("{Left}")    ; 左
^l::Send("{Right}")   ; 右

; ==============================================================================
; 3. 大跨度跳转 (行首/行尾)
; ==============================================================================

^u::Send("{Home}")    ; 行首
^o::Send("{End}")     ; 行尾

; ==============================================================================
; 4. 分级变速 (Alt + I J K L) - 实现你想要的“跳单词”和“跳5行”
; ==============================================================================

; Alt + J/L：跳单词
!j::Send("^{Left}")   ; 向左跳一个词
!l::Send("^{Right}")  ; 向右跳一个词

; Alt + I/K：跳 5 行 (核心需求实现)
!i:: {
    Loop 5
        Send("{Up}")
}
!k:: {
    Loop 5
        Send("{Down}")
}

; ==============================================================================
; 5. 增强选中功能 (解决你提到的 Ctrl + Shift + J 冲突)
; 显式定义 Shift 组合，确保优先级最高
; ==============================================================================

; Ctrl + Shift + 导航 = 字符选中
^+j::Send("+{Left}")
^+l::Send("+{Right}")
^+i::Send("+{Up}")
^+k::Send("+{Down}")
^+u::Send("+{Home}")
^+o::Send("+{End}")

; Alt + Shift + J/L = 单词选中
+!j::Send("^+{Left}")
+!l::Send("^+{Right}")

; ==============================================================================
; 6. 高级彩蛋：单击 Caps Lock 变 Esc (Vim 模式神器)
; 如果长按 CapsLock 是 Ctrl，快速点一下则是 Esc
; ==============================================================================
/*
*CapsLock::
{
    Send("{Ctrl down}")
    KeyWait("CapsLock")
    Send("{Ctrl up}")
    if (A_PriorKey = "CapsLock")
    {
        Send("{Esc}")
    }
}
*/